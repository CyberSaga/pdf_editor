# PDF 編輯器功能說明

本文件整理此視覺化 PDF 編輯器的各項功能。

---

## 一、檔案操作

| 功能 | 說明 |
|------|------|
| **開啟** | 開啟 PDF 檔案 |
| **儲存** | 儲存回原檔（Ctrl+S），若適用則使用增量更新（Incremental Update），減少對數位簽章與大檔案的影響 |
| **另存** | 另存為新 PDF 檔 |

---

## 二、頁面操作

| 功能 | 說明 |
|------|------|
| **刪除頁** | 刪除指定頁面，支援頁碼格式如 `1,3-5` |
| **旋轉頁** | 旋轉指定頁面，可選擇 90°、180°、270° |
| **匯出頁** | 將指定頁面匯出為 PDF 或 PNG 影像 |
| **插入空白頁** | 在指定位置插入空白頁面（尺寸沿用第一頁或 A4） |
| **從檔案插入頁** | 從其他 PDF 檔案選取頁面，插入至當前文件指定位置 |

---

## 三、檢視與導覽

| 功能 | 說明 |
|------|------|
| **縮圖** | 左側面板顯示所有頁面縮圖，點擊可跳轉 |
| **連續捲動** | 所有頁面由上到下連續排列，可滑動捲軸切換頁面 |
| **縮放** | Ctrl + 滑鼠滾輪 縮放顯示比例 |
| **瀏覽模式** | 預設模式，可拖曳捲動檢視 |

---

## 四、文字編輯

| 功能 | 說明 |
|------|------|
| **編輯文字** | 按 F2 或工具列切換到編輯模式，點擊文字區塊即可編輯 |
| **精確定位** | 透過文字方塊索引與相似度比對，只清除目標文字框，不影響其他文字 |
| **字型設定** | 支援選擇字型、字級大小、顏色 |
| **中西文支援** | 正確處理中英混合、CJK 字元顯示 |

---

## 五、標註與繪圖

| 功能 | 說明 |
|------|------|
| **螢光筆** | 在頁面上繪製螢光筆標記，可自訂顏色 |
| **矩形** | 繪製矩形標記，可選空心或填滿，可調透明度與顏色 |
| **新增註解** | 在頁面指定位置新增 FreeText 文字註解 |
| **註解列表** | 右側面板列出所有註解，點擊可跳轉至對應位置 |
| **顯示/隱藏註解** | 切換所有 FreeText 註解的可見性 |

---

## 六、浮水印

| 功能 | 說明 |
|------|------|
| **添加浮水印** | 在指定頁面添加文字浮水印 |
| **多行文字** | 支援多行浮水印，可設定行距倍率 |
| **自訂設定** | 可調旋轉角度、透明度、字型大小、顏色、字型 |
| **位置偏移** | 支援水平、垂直偏移調整 |
| **套用範圍** | 可指定頁面範圍（如 `1,3-5` 或全部） |
| **浮水印列表** | 檢視、編輯、移除已添加的浮水印 |

---

## 七、搜尋

| 功能 | 說明 |
|------|------|
| **文字搜尋** | 搜尋 PDF 內文字（Ctrl+F 或工具列） |
| **搜尋結果** | 顯示所有匹配結果及上下文 |
| **上一個/下一個** | 在搜尋結果間導覽 |
| **跳轉高亮** | 點擊結果可跳轉至對應頁面，並短暫高亮標示 |

---

## 八、OCR

| 功能 | 說明 |
|------|------|
| **OCR 頁面** | 對指定頁面執行 OCR（光學字元辨識），需安裝 Tesseract |

---

## 九、匯出與快照

| 功能 | 說明 |
|------|------|
| **快照** | 將當前頁面轉換為扁平化影像（含註解、浮水印），複製至剪貼簿 |

---

## 十、復原與重做

| 功能 | 說明 |
|------|------|
| **復原** | Ctrl+Z 復原上一步操作 |
| **重做** | Ctrl+Y 重做已復原的操作 |

---

## 十一、其他

| 功能 | 說明 |
|------|------|
| **未儲存提醒** | 關閉視窗時若有未儲存變更，會提示儲存或放棄 |
| **文字方塊索引** | 建立每頁文字方塊索引，支援精確編輯定位 |
| **增量儲存** | 存回原檔時可選用增量更新，減少對已簽章 PDF 的影響 |

---

## 技術架構

- **UI 框架**：PySide6 (Qt)
- **PDF 引擎**：PyMuPDF (fitz)
- **架構模式**：MVC（Model-View-Controller）
- **OCR**：pytesseract + PIL
