======================================================================
  PDF 編輯器深度測試報告
  生成時間：2026-02-23 18:37:03
  總耗時：49.4s
======================================================================

【總覽】
  測試套件: 10 個
  測試案例: 183 個
  通過: 183  失敗: 0
  整體通過率: 100.0%

──────────────────────────────────────────────────────────────────────
【各套件摘要】
  ID    套件名稱                                通過     失敗     通過率      耗時
  ───── ─────────────────────────────────── ────── ────── ──────── ────────
  T1    連續/重複編輯同一文字塊（20–50次）                33     0       100.0%  16.27s  ✓
  T2    Undo/Redo 完整循環驗證（多輪）                33     0       100.0%  19.79s  ✓
  T3    極端輸入內容（超長、特殊符號、CJK/RTL）             36     0       100.0%  0.93s  ✓
  T4    多頁/跨頁操作組合（編輯+刪頁+旋轉+undo）            6      0       100.0%  4.33s  ✓
  T5    註解/表單共存測試                           10     0       100.0%  0.27s  ✓
  T6    頁面結構改變後的編輯（旋轉、插入頁）                  10     0       100.0%  0.31s  ✓
  T7    記憶體與資源壓力測試                          5      0       100.0%  3.51s  ✓
  T8    異常與邊界情境                             11     0       100.0%  0.10s  ✓
  T9    效能分佈分析（耗時統計、瓶頸標記）                   34     0       100.0%  3.44s  ✓
  T10   視覺輸出驗證（save_as + pixmap 差異比對）       5      0       100.0%  0.44s  ✓

══════════════════════════════════════════════════════════════════════
【T1】連續/重複編輯同一文字塊（20–50次）
  通過率：33/33 (100.0%)  avg=475ms  總耗時=16.27s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (33個) ──
  [OK]   minimal-document.pdf  (307ms)
         → 成功=20/20，avg=15.3ms/次
  [OK]   002-trivial-libre-office-writer.pdf  (292ms)
         → 成功=20/20，avg=14.6ms/次
  [OK]   pdflatex-image.pdf  (332ms)
         → 成功=20/20，avg=16.6ms/次
  [OK]   pdflatex-4-pages.pdf  (288ms)
         → 成功=20/20，avg=14.4ms/次
  [OK]   libreoffice-writer-password.pdf  (284ms)
         → 成功=20/20，avg=14.2ms/次
  [OK]   pdflatex-outline.pdf  (568ms)
         → 成功=20/20，avg=28.4ms/次
  [OK]   inline-image.pdf  (283ms)
         → 成功=20/20，avg=14.1ms/次
  [OK]   GeoTopo-komprimiert.pdf  (2203ms)
         → 成功=20/20，avg=110.2ms/次
  [OK]   GeoTopo.pdf  (2344ms)
         → 成功=20/20，avg=117.2ms/次
  [OK]   pdflatex-forms.pdf  (995ms)
         → 成功=20/20，avg=49.7ms/次
         ... 另有 23 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T2】Undo/Redo 完整循環驗證（多輪）
  通過率：33/33 (100.0%)  avg=580ms  總耗時=19.79s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (33個) ──
  [OK]   minimal-document.pdf  (277ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   002-trivial-libre-office-writer.pdf  (265ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-image.pdf  (444ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-4-pages.pdf  (315ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   libreoffice-writer-password.pdf  (260ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-outline.pdf  (577ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   inline-image.pdf  (274ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   GeoTopo-komprimiert.pdf  (3180ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   GeoTopo.pdf  (3352ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-forms.pdf  (383ms)
         → 3輪×5次 edit，undo/redo 循環
         ... 另有 23 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T3】極端輸入內容（超長、特殊符號、CJK/RTL）
  通過率：36/36 (100.0%)  avg=24ms  總耗時=0.93s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (36個) ──
  [OK]   minimal-document.pdf[input1]  (18ms)
         → 輸入1: len=600, EXPECTED_ROLLBACK（超長文字保護機制）
  [OK]   minimal-document.pdf[input2]  (24ms)
         → 輸入2: len=446, OK
  [OK]   minimal-document.pdf[input3]  (13ms)
         → 輸入3: len=42, OK
  [OK]   minimal-document.pdf[input4]  (23ms)
         → 輸入4: len=39, OK
  [OK]   minimal-document.pdf[input5]  (10ms)
         → 輸入5: len=25, OK
  [OK]   minimal-document.pdf[input6]  (28ms)
         → 輸入6: len=252, OK
  [OK]   002-trivial-libre-office-writer.pdf[input1]  (12ms)
         → 輸入1: len=600, EXPECTED_ROLLBACK（超長文字保護機制）
  [OK]   002-trivial-libre-office-writer.pdf[input2]  (19ms)
         → 輸入2: len=446, OK
  [OK]   002-trivial-libre-office-writer.pdf[input3]  (13ms)
         → 輸入3: len=42, OK
  [OK]   002-trivial-libre-office-writer.pdf[input4]  (19ms)
         → 輸入4: len=39, OK
         ... 另有 26 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T4】多頁/跨頁操作組合（編輯+刪頁+旋轉+undo）
  通過率：6/6 (100.0%)  avg=540ms  總耗時=4.33s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (6個) ──
  [OK]   pdflatex-4-pages.pdf  (63ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4
  [OK]   pdflatex-outline.pdf  (257ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4
  [OK]   imagemagick-images.pdf  (0ms)
         → SKIP：純圖片 PDF，無可編輯文字（原始頁數=6）
  [OK]   GeoTopo-komprimiert.pdf  (1222ms)
         → 原始頁數=117，編輯頁=[1, 2, 3]，undo 全部後頁數=117
  [OK]   GeoTopo.pdf  (1459ms)
         → 原始頁數=117，編輯頁=[1, 2, 3]，undo 全部後頁數=117
  [OK]   mistitled_outlines_example.pdf  (236ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4

══════════════════════════════════════════════════════════════════════
【T5】註解/表單共存測試
  通過率：10/10 (100.0%)  avg=23ms  總耗時=0.27s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (10個) ──
  [OK]   minimal-document.pdf  (30ms)
         → 頁面含 2 個 annot
  [OK]   002-trivial-libre-office-writer.pdf  (33ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-image.pdf  (39ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-4-pages.pdf  (32ms)
         → 頁面含 2 個 annot
  [OK]   libreoffice-writer-password.pdf  (30ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-outline.pdf  (46ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-ASCII85Decode.pdf  (5ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-CCITTFaxDecode.pdf  (5ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-images.pdf  (5ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-lzw.pdf  (5ms)
         → 頁面含 2 個 annot

══════════════════════════════════════════════════════════════════════
【T6】頁面結構改變後的編輯（旋轉、插入頁）
  通過率：10/10 (100.0%)  avg=27ms  總耗時=0.31s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (10個) ──
  [OK]   minimal-document.pdf  (38ms)
         → 原始頁=1，操作後頁=2
  [OK]   002-trivial-libre-office-writer.pdf  (35ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-image.pdf  (52ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-4-pages.pdf  (50ms)
         → 原始頁=4，操作後頁=5
  [OK]   libreoffice-writer-password.pdf  (31ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-outline.pdf  (66ms)
         → 原始頁=4，操作後頁=5
  [OK]   imagemagick-ASCII85Decode.pdf  (0ms)
         → 原始頁=1，操作後頁=2
  [OK]   imagemagick-CCITTFaxDecode.pdf  (0ms)
         → 原始頁=1，操作後頁=2
  [OK]   imagemagick-images.pdf  (1ms)
         → 原始頁=6，操作後頁=7
  [OK]   imagemagick-lzw.pdf  (0ms)
         → 原始頁=1，操作後頁=2

══════════════════════════════════════════════════════════════════════
【T7】記憶體與資源壓力測試
  通過率：5/5 (100.0%)  avg=697ms  總耗時=3.51s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (5個) ──
  [OK]   minimal-document.pdf  (678ms)
         → 30次 edit，記憶體峰值增長=+3.5MB (10.4→14.0)，avg=22.6ms
  [OK]   002-trivial-libre-office-writer.pdf  (665ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.4→10.5)，avg=22.2ms
  [OK]   pdflatex-image.pdf  (759ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.6→10.7)，avg=25.3ms
  [OK]   pdflatex-4-pages.pdf  (729ms)
         → 30次 edit，記憶體峰值增長=+3.7MB (10.4→14.1)，avg=24.3ms
  [OK]   libreoffice-writer-password.pdf  (656ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.4→10.6)，avg=21.9ms

══════════════════════════════════════════════════════════════════════
【T8】異常與邊界情境
  通過率：11/11 (100.0%)  avg=0ms  總耗時=0.10s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (11個) ──
  [OK]   無文字PDF(1頁空白)  (0ms)
         → 1頁無文字 PDF，blocks=0
  [OK]   極小頁面(1pt×1pt)  (0ms)
         → 1pt×1pt 頁面，有文字 edit=FAIL
  [OK]   極大頁面(A0)  (0ms)
         → A0頁面(2384×3370)，edit=OK
  [OK]   minimal-document.pdf[無效rect]  (1ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   002-trivial-libre-office-writer.pdf[無效rect]  (1ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   pdflatex-image.pdf[無效rect]  (1ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   minimal-document.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   002-trivial-libre-office-writer.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   pdflatex-image.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   minimal-document.pdf[空堆疊undo]  (0ms)
         → 空 undo 堆疊呼叫 undo() → False
         ... 另有 1 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T9】效能分佈分析（耗時統計、瓶頸標記）
  通過率：34/34 (100.0%)  avg=163ms  總耗時=3.44s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (34個) ──
  [OK]   minimal-document.pdf  (71ms)
         → n=5 avg=14ms max=25ms p95=25ms 
  [OK]   002-trivial-libre-office-writer.pdf  (67ms)
         → n=5 avg=13ms max=22ms p95=22ms 
  [OK]   pdflatex-image.pdf  (87ms)
         → n=5 avg=17ms max=25ms p95=25ms 
  [OK]   pdflatex-4-pages.pdf  (71ms)
         → n=5 avg=14ms max=20ms p95=20ms 
  [OK]   libreoffice-writer-password.pdf  (69ms)
         → n=5 avg=14ms max=23ms p95=23ms 
  [OK]   pdflatex-outline.pdf  (106ms)
         → n=5 avg=21ms max=25ms p95=25ms 
  [OK]   inline-image.pdf  (62ms)
         → n=5 avg=12ms max=19ms p95=19ms 
  [OK]   GeoTopo-komprimiert.pdf  (117ms)
         → n=5 avg=23ms max=30ms p95=30ms 
  [OK]   GeoTopo.pdf  (121ms)
         → n=5 avg=24ms max=29ms p95=29ms 
  [OK]   pdflatex-forms.pdf  (87ms)
         → n=5 avg=17ms max=24ms p95=24ms 
         ... 另有 24 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T10】視覺輸出驗證（save_as + pixmap 差異比對）
  通過率：5/5 (100.0%)  avg=84ms  總耗時=0.44s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (5個) ──
  [OK]   minimal-document.pdf  (79ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   002-trivial-libre-office-writer.pdf  (74ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   pdflatex-image.pdf  (108ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   pdflatex-4-pages.pdf  (91ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   libreoffice-writer-password.pdf  (70ms)
         → before/after pixmap 不同=是，save_as 成功

══════════════════════════════════════════════════════════════════════
【根因分析與建議】
  無失敗案例，所有測試通過 ✓

══════════════════════════════════════════════════════════════════════
【穩定性結論】
  ✅ 可視為穩定版本
  整體通過率 ≥ 95%，各核心功能表現穩健。

【剩餘建議】
  1. 定期對 veraPDF 語料庫全量跑 T1+T2，確保新功能不破壞回歸穩定性
  2. T7 記憶體壓力測試建議加入 psutil 監控系統記憶體（tracemalloc 僅追蹤 Python heap）
  3. T10 視覺比對可引入 PIL/numpy 的像素差分（SSIM）取代 bytes 直接比對
  4. 對 RTL/Arabic PDF (015-arabic) 的編輯結果需人工視覺驗證，自動化較難覆蓋
  5. 考慮加入 CI 整合，在每次 commit 後自動執行 T1~T9 快速模式

======================================================================