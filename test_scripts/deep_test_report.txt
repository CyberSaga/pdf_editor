======================================================================
  PDF 編輯器深度測試報告
  生成時間：2026-02-22 23:39:21
  總耗時：57.0s
======================================================================

【總覽】
  測試套件: 10 個
  測試案例: 183 個
  通過: 183  失敗: 0
  整體通過率: 100.0%

──────────────────────────────────────────────────────────────────────
【各套件摘要】
  ID    套件名稱                                通過     失敗     通過率      耗時
  ───── ─────────────────────────────────── ────── ────── ──────── ────────
  T1    連續/重複編輯同一文字塊（20–50次）                33     0       100.0%  19.43s  ✓
  T2    Undo/Redo 完整循環驗證（多輪）                33     0       100.0%  22.09s  ✓
  T3    極端輸入內容（超長、特殊符號、CJK/RTL）             36     0       100.0%  0.64s  ✓
  T4    多頁/跨頁操作組合（編輯+刪頁+旋轉+undo）            6      0       100.0%  5.82s  ✓
  T5    註解/表單共存測試                           10     0       100.0%  0.33s  ✓
  T6    頁面結構改變後的編輯（旋轉、插入頁）                  10     0       100.0%  0.30s  ✓
  T7    記憶體與資源壓力測試                          5      0       100.0%  3.98s  ✓
  T8    異常與邊界情境                             11     0       100.0%  0.23s  ✓
  T9    效能分佈分析（耗時統計、瓶頸標記）                   34     0       100.0%  3.59s  ✓
  T10   視覺輸出驗證（save_as + pixmap 差異比對）       5      0       100.0%  0.61s  ✓

══════════════════════════════════════════════════════════════════════
【T1】連續/重複編輯同一文字塊（20–50次）
  通過率：33/33 (100.0%)  avg=557ms  總耗時=19.43s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (33個) ──
  [OK]   minimal-document.pdf  (331ms)
         → 成功=20/20，avg=16.6ms/次
  [OK]   002-trivial-libre-office-writer.pdf  (381ms)
         → 成功=20/20，avg=19.1ms/次
  [OK]   pdflatex-image.pdf  (362ms)
         → 成功=20/20，avg=18.1ms/次
  [OK]   pdflatex-4-pages.pdf  (391ms)
         → 成功=20/20，avg=19.5ms/次
  [OK]   libreoffice-writer-password.pdf  (381ms)
         → 成功=20/20，avg=19.0ms/次
  [OK]   pdflatex-outline.pdf  (738ms)
         → 成功=20/20，avg=36.9ms/次
  [OK]   inline-image.pdf  (379ms)
         → 成功=20/20，avg=18.9ms/次
  [OK]   GeoTopo-komprimiert.pdf  (2517ms)
         → 成功=20/20，avg=125.8ms/次
  [OK]   GeoTopo.pdf  (2676ms)
         → 成功=20/20，avg=133.8ms/次
  [OK]   pdflatex-forms.pdf  (417ms)
         → 成功=20/20，avg=20.9ms/次
         ... 另有 23 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T2】Undo/Redo 完整循環驗證（多輪）
  通過率：33/33 (100.0%)  avg=638ms  總耗時=22.09s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (33個) ──
  [OK]   minimal-document.pdf  (392ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   002-trivial-libre-office-writer.pdf  (355ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-image.pdf  (395ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-4-pages.pdf  (438ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   libreoffice-writer-password.pdf  (346ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-outline.pdf  (466ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   inline-image.pdf  (378ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   GeoTopo-komprimiert.pdf  (4181ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   GeoTopo.pdf  (4253ms)
         → 3輪×5次 edit，undo/redo 循環
  [OK]   pdflatex-forms.pdf  (435ms)
         → 3輪×5次 edit，undo/redo 循環
         ... 另有 23 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T3】極端輸入內容（超長、特殊符號、CJK/RTL）
  通過率：36/36 (100.0%)  avg=16ms  總耗時=0.64s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (36個) ──
  [OK]   minimal-document.pdf[input1]  (19ms)
         → 輸入1: len=600, EXPECTED_ROLLBACK（超長文字保護機制）
  [OK]   minimal-document.pdf[input2]  (22ms)
         → 輸入2: len=446, OK
  [OK]   minimal-document.pdf[input3]  (15ms)
         → 輸入3: len=42, OK
  [OK]   minimal-document.pdf[input4]  (23ms)
         → 輸入4: len=39, OK
  [OK]   minimal-document.pdf[input5]  (13ms)
         → 輸入5: len=25, OK
  [OK]   minimal-document.pdf[input6]  (37ms)
         → 輸入6: len=252, OK
  [OK]   002-trivial-libre-office-writer.pdf[input1]  (16ms)
         → 輸入1: len=600, EXPECTED_ROLLBACK（超長文字保護機制）
  [OK]   002-trivial-libre-office-writer.pdf[input2]  (16ms)
         → 輸入2: len=446, OK
  [OK]   002-trivial-libre-office-writer.pdf[input3]  (18ms)
         → 輸入3: len=42, OK
  [OK]   002-trivial-libre-office-writer.pdf[input4]  (26ms)
         → 輸入4: len=39, OK
         ... 另有 26 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T4】多頁/跨頁操作組合（編輯+刪頁+旋轉+undo）
  通過率：6/6 (100.0%)  avg=697ms  總耗時=5.82s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (6個) ──
  [OK]   pdflatex-4-pages.pdf  (82ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4
  [OK]   pdflatex-outline.pdf  (118ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4
  [OK]   imagemagick-images.pdf  (0ms)
         → SKIP：純圖片 PDF，無可編輯文字（原始頁數=6）
  [OK]   GeoTopo-komprimiert.pdf  (1761ms)
         → 原始頁數=117，編輯頁=[1, 2, 3]，undo 全部後頁數=117
  [OK]   GeoTopo.pdf  (2097ms)
         → 原始頁數=117，編輯頁=[1, 2, 3]，undo 全部後頁數=117
  [OK]   mistitled_outlines_example.pdf  (124ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4

══════════════════════════════════════════════════════════════════════
【T5】註解/表單共存測試
  通過率：10/10 (100.0%)  avg=27ms  總耗時=0.33s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (10個) ──
  [OK]   minimal-document.pdf  (44ms)
         → 頁面含 2 個 annot
  [OK]   002-trivial-libre-office-writer.pdf  (41ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-image.pdf  (36ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-4-pages.pdf  (46ms)
         → 頁面含 2 個 annot
  [OK]   libreoffice-writer-password.pdf  (44ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-outline.pdf  (38ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-ASCII85Decode.pdf  (6ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-CCITTFaxDecode.pdf  (7ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-images.pdf  (6ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-lzw.pdf  (5ms)
         → 頁面含 2 個 annot

══════════════════════════════════════════════════════════════════════
【T6】頁面結構改變後的編輯（旋轉、插入頁）
  通過率：10/10 (100.0%)  avg=23ms  總耗時=0.30s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (10個) ──
  [OK]   minimal-document.pdf  (30ms)
         → 原始頁=1，操作後頁=2
  [OK]   002-trivial-libre-office-writer.pdf  (33ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-image.pdf  (35ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-4-pages.pdf  (53ms)
         → 原始頁=4，操作後頁=5
  [OK]   libreoffice-writer-password.pdf  (36ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-outline.pdf  (41ms)
         → 原始頁=4，操作後頁=5
  [OK]   imagemagick-ASCII85Decode.pdf  (0ms)
         → 原始頁=1，操作後頁=2
  [OK]   imagemagick-CCITTFaxDecode.pdf  (0ms)
         → 原始頁=1，操作後頁=2
  [OK]   imagemagick-images.pdf  (1ms)
         → 原始頁=6，操作後頁=7
  [OK]   imagemagick-lzw.pdf  (0ms)
         → 原始頁=1，操作後頁=2

══════════════════════════════════════════════════════════════════════
【T7】記憶體與資源壓力測試
  通過率：5/5 (100.0%)  avg=787ms  總耗時=3.98s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (5個) ──
  [OK]   minimal-document.pdf  (776ms)
         → 30次 edit，記憶體峰值增長=+3.6MB (10.4→14.0)，avg=25.9ms
  [OK]   002-trivial-libre-office-writer.pdf  (767ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.4→10.5)，avg=25.6ms
  [OK]   pdflatex-image.pdf  (803ms)
         → 30次 edit，記憶體峰值增長=+0.2MB (10.5→10.6)，avg=26.8ms
  [OK]   pdflatex-4-pages.pdf  (898ms)
         → 30次 edit，記憶體峰值增長=+3.6MB (10.4→14.0)，avg=29.9ms
  [OK]   libreoffice-writer-password.pdf  (691ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.4→10.5)，avg=23.0ms

══════════════════════════════════════════════════════════════════════
【T8】異常與邊界情境
  通過率：11/11 (100.0%)  avg=1ms  總耗時=0.23s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (11個) ──
  [OK]   無文字PDF(1頁空白)  (0ms)
         → 1頁無文字 PDF，blocks=0
  [OK]   極小頁面(1pt×1pt)  (0ms)
         → 1pt×1pt 頁面，有文字 edit=FAIL
  [OK]   極大頁面(A0)  (0ms)
         → A0頁面(2384×3370)，edit=OK
  [OK]   minimal-document.pdf[無效rect]  (2ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   002-trivial-libre-office-writer.pdf[無效rect]  (2ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   pdflatex-image.pdf[無效rect]  (3ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   minimal-document.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   002-trivial-libre-office-writer.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   pdflatex-image.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   minimal-document.pdf[空堆疊undo]  (0ms)
         → 空 undo 堆疊呼叫 undo() → False
         ... 另有 1 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T9】效能分佈分析（耗時統計、瓶頸標記）
  通過率：34/34 (100.0%)  avg=153ms  總耗時=3.59s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (34個) ──
  [OK]   minimal-document.pdf  (91ms)
         → n=5 avg=18ms max=25ms p95=25ms 
  [OK]   002-trivial-libre-office-writer.pdf  (64ms)
         → n=5 avg=13ms max=17ms p95=17ms 
  [OK]   pdflatex-image.pdf  (79ms)
         → n=5 avg=16ms max=25ms p95=25ms 
  [OK]   pdflatex-4-pages.pdf  (86ms)
         → n=5 avg=17ms max=30ms p95=30ms 
  [OK]   libreoffice-writer-password.pdf  (76ms)
         → n=5 avg=15ms max=25ms p95=25ms 
  [OK]   pdflatex-outline.pdf  (78ms)
         → n=5 avg=16ms max=23ms p95=23ms 
  [OK]   inline-image.pdf  (74ms)
         → n=5 avg=15ms max=21ms p95=21ms 
  [OK]   GeoTopo-komprimiert.pdf  (146ms)
         → n=5 avg=29ms max=37ms p95=37ms 
  [OK]   GeoTopo.pdf  (150ms)
         → n=5 avg=30ms max=44ms p95=44ms 
  [OK]   pdflatex-forms.pdf  (88ms)
         → n=5 avg=18ms max=23ms p95=23ms 
         ... 另有 24 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【T10】視覺輸出驗證（save_as + pixmap 差異比對）
  通過率：5/5 (100.0%)  avg=115ms  總耗時=0.61s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (5個) ──
  [OK]   minimal-document.pdf  (88ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   002-trivial-libre-office-writer.pdf  (135ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   pdflatex-image.pdf  (128ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   pdflatex-4-pages.pdf  (129ms)
         → before/after pixmap 不同=是，save_as 成功
  [OK]   libreoffice-writer-password.pdf  (93ms)
         → before/after pixmap 不同=是，save_as 成功

══════════════════════════════════════════════════════════════════════
【根因分析與建議】
  無失敗案例，所有測試通過 ✓

══════════════════════════════════════════════════════════════════════
【穩定性結論】
  ✅ 可視為穩定版本
  整體通過率 ≥ 95%，各核心功能表現穩健。

【剩餘建議】
  1. 定期對 veraPDF 語料庫全量跑 T1+T2，確保新功能不破壞回歸穩定性
  2. T7 記憶體壓力測試建議加入 psutil 監控系統記憶體（tracemalloc 僅追蹤 Python heap）
  3. T10 視覺比對可引入 PIL/numpy 的像素差分（SSIM）取代 bytes 直接比對
  4. 對 RTL/Arabic PDF (015-arabic) 的編輯結果需人工視覺驗證，自動化較難覆蓋
  5. 考慮加入 CI 整合，在每次 commit 後自動執行 T1~T9 快速模式

======================================================================