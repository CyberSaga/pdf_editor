======================================================================
  PDF 編輯器深度測試報告
  生成時間：2026-02-23 16:04:55
  總耗時：8.6s
======================================================================

【總覽】
  測試套件: 5 個
  測試案例: 42 個
  通過: 42  失敗: 0
  整體通過率: 100.0%

──────────────────────────────────────────────────────────────────────
【各套件摘要】
  ID    套件名稱                                通過     失敗     通過率      耗時
  ───── ─────────────────────────────────── ────── ────── ──────── ────────
  T4    多頁/跨頁操作組合（編輯+刪頁+旋轉+undo）            6      0       100.0%  4.47s  ✓
  T5    註解/表單共存測試                           10     0       100.0%  0.29s  ✓
  T6    頁面結構改變後的編輯（旋轉、插入頁）                  10     0       100.0%  0.32s  ✓
  T7    記憶體與資源壓力測試                          5      0       100.0%  3.45s  ✓
  T8    異常與邊界情境                             11     0       100.0%  0.11s  ✓

══════════════════════════════════════════════════════════════════════
【T4】多頁/跨頁操作組合（編輯+刪頁+旋轉+undo）
  通過率：6/6 (100.0%)  avg=559ms  總耗時=4.47s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (6個) ──
  [OK]   pdflatex-4-pages.pdf  (65ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4
  [OK]   pdflatex-outline.pdf  (262ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4
  [OK]   imagemagick-images.pdf  (0ms)
         → SKIP：純圖片 PDF，無可編輯文字（原始頁數=6）
  [OK]   GeoTopo-komprimiert.pdf  (1257ms)
         → 原始頁數=117，編輯頁=[1, 2, 3]，undo 全部後頁數=117
  [OK]   GeoTopo.pdf  (1492ms)
         → 原始頁數=117，編輯頁=[1, 2, 3]，undo 全部後頁數=117
  [OK]   mistitled_outlines_example.pdf  (276ms)
         → 原始頁數=4，編輯頁=[1, 2, 3]，undo 全部後頁數=4

══════════════════════════════════════════════════════════════════════
【T5】註解/表單共存測試
  通過率：10/10 (100.0%)  avg=25ms  總耗時=0.29s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (10個) ──
  [OK]   minimal-document.pdf  (45ms)
         → 頁面含 2 個 annot
  [OK]   002-trivial-libre-office-writer.pdf  (32ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-image.pdf  (44ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-4-pages.pdf  (34ms)
         → 頁面含 2 個 annot
  [OK]   libreoffice-writer-password.pdf  (28ms)
         → 頁面含 2 個 annot
  [OK]   pdflatex-outline.pdf  (46ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-ASCII85Decode.pdf  (6ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-CCITTFaxDecode.pdf  (4ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-images.pdf  (5ms)
         → 頁面含 2 個 annot
  [OK]   imagemagick-lzw.pdf  (5ms)
         → 頁面含 2 個 annot

══════════════════════════════════════════════════════════════════════
【T6】頁面結構改變後的編輯（旋轉、插入頁）
  通過率：10/10 (100.0%)  avg=28ms  總耗時=0.32s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (10個) ──
  [OK]   minimal-document.pdf  (38ms)
         → 原始頁=1，操作後頁=2
  [OK]   002-trivial-libre-office-writer.pdf  (34ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-image.pdf  (45ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-4-pages.pdf  (52ms)
         → 原始頁=4，操作後頁=5
  [OK]   libreoffice-writer-password.pdf  (31ms)
         → 原始頁=1，操作後頁=2
  [OK]   pdflatex-outline.pdf  (74ms)
         → 原始頁=4，操作後頁=5
  [OK]   imagemagick-ASCII85Decode.pdf  (0ms)
         → 原始頁=1，操作後頁=2
  [OK]   imagemagick-CCITTFaxDecode.pdf  (0ms)
         → 原始頁=1，操作後頁=2
  [OK]   imagemagick-images.pdf  (1ms)
         → 原始頁=6，操作後頁=7
  [OK]   imagemagick-lzw.pdf  (0ms)
         → 原始頁=1，操作後頁=2

══════════════════════════════════════════════════════════════════════
【T7】記憶體與資源壓力測試
  通過率：5/5 (100.0%)  avg=685ms  總耗時=3.45s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (5個) ──
  [OK]   minimal-document.pdf  (687ms)
         → 30次 edit，記憶體峰值增長=+3.5MB (10.4→14.0)，avg=22.9ms
  [OK]   002-trivial-libre-office-writer.pdf  (641ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.4→10.5)，avg=21.4ms
  [OK]   pdflatex-image.pdf  (735ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.6→10.7)，avg=24.5ms
  [OK]   pdflatex-4-pages.pdf  (713ms)
         → 30次 edit，記憶體峰值增長=+3.7MB (10.4→14.1)，avg=23.8ms
  [OK]   libreoffice-writer-password.pdf  (649ms)
         → 30次 edit，記憶體峰值增長=+0.1MB (10.4→10.6)，avg=21.6ms

══════════════════════════════════════════════════════════════════════
【T8】異常與邊界情境
  通過率：11/11 (100.0%)  avg=0ms  總耗時=0.11s
──────────────────────────────────────────────────────────────────────
  ── 通過案例 (11個) ──
  [OK]   無文字PDF(1頁空白)  (0ms)
         → 1頁無文字 PDF，blocks=0
  [OK]   極小頁面(1pt×1pt)  (0ms)
         → 1pt×1pt 頁面，有文字 edit=FAIL
  [OK]   極大頁面(A0)  (0ms)
         → A0頁面(2384×3370)，edit=OK
  [OK]   minimal-document.pdf[無效rect]  (1ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   002-trivial-libre-office-writer.pdf[無效rect]  (1ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   pdflatex-image.pdf[無效rect]  (2ms)
         → edit_text(rect=0,0,0,0) graceful 無 crash
  [OK]   minimal-document.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   002-trivial-libre-office-writer.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   pdflatex-image.pdf[頁碼超界]  (0ms)
         → page=9999 拋例外（可接受）
  [OK]   minimal-document.pdf[空堆疊undo]  (0ms)
         → 空 undo 堆疊呼叫 undo() → False
         ... 另有 1 個通過案例（省略）

══════════════════════════════════════════════════════════════════════
【根因分析與建議】
  無失敗案例，所有測試通過 ✓

══════════════════════════════════════════════════════════════════════
【穩定性結論】
  ✅ 可視為穩定版本
  整體通過率 ≥ 95%，各核心功能表現穩健。

【剩餘建議】
  1. 定期對 veraPDF 語料庫全量跑 T1+T2，確保新功能不破壞回歸穩定性
  2. T7 記憶體壓力測試建議加入 psutil 監控系統記憶體（tracemalloc 僅追蹤 Python heap）
  3. T10 視覺比對可引入 PIL/numpy 的像素差分（SSIM）取代 bytes 直接比對
  4. 對 RTL/Arabic PDF (015-arabic) 的編輯結果需人工視覺驗證，自動化較難覆蓋
  5. 考慮加入 CI 整合，在每次 commit 後自動執行 T1~T9 快速模式

======================================================================